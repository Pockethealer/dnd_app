{%extends "base.html"%} {%block title%}Admin dashboard{%endblock%} {% block
content %}

<body class="bg-light">
  <div class="container">
    <h2>Admin Dashboard</h2>

    <table class="table table-bordered table-admin">
      <thead class="table-light">
        <tr>
          <th>ID</th>
          <th>Email</th>
          <th>First Name</th>
          <th>Admin</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for user in users %}
        <tr>
          <td>{{ user.id }}</td>
          <td>{{ user.email }}</td>
          <td>
            <a
              href="#"
              class="link"
              data-name="{{ user.name }}"
              data-model="user"
              >{{ user.name }}</a
            >
          </td>
          <td>{{ 'Yes' if user.is_admin else 'No' }}</td>
          <td>
            {% if not user.is_admin %}
            <form
              action="{{ url_for('admin.delete_user', user_id=user.id) }}"
              method="POST"
              style="display: inline"
              onsubmit="return confirm('Delete this user?');"
            >
              <button class="btn btn-sm btn-danger">Delete</button>
            </form>
            {% else %}
            <span class="text-muted">Admin</span>
            {% endif %}
          </td>
          <td>
            <form
              action="{{ url_for('admin.add_votes', user_id=user.id, count=3) }}"
              method="POST"
              style="display: inline"
              onsubmit="return confirm('Add votes?');"
            >
              <button class="btn btn-success">Add votes</button>
            </form>
          </td>
          <td>
            <form
              action="{{ url_for('admin.add_votes', user_id=user.id, count=-3) }}"
              method="POST"
              style="display: inline"
              onsubmit="return confirm('Remove votes?');"
            >
              <button class="btn btn-sm btn-danger">Remove 3 votes</button>
            </form>
          </td>
          <td>
            <form
              action="{{ url_for('admin.add_tokens', user_id=user.id, count=1) }}"
              method="POST"
              style="display: inline"
              onsubmit="return confirm('Add token?');"
            >
              <button class="btn btn-success">Add one token</button>
            </form>
          </td>
          <td>
            <form
              method="POST"
              style="display: inline"
              onsubmit="
                            var c = this.querySelector('input[name=count]').value;
                            if(!c || c <= 0){ alert('Enter a valid number'); return false; }
                            this.action='{{ url_for('admin.add_tokens', user_id=user.id, count=0) }}'.replace('/0','/'+c);
                            return confirm('Add tokens?');
                        "
            >
              <input
                type="number"
                name="count"
                min="1"
                value="10"
                style="width: 60px; margin-right: 5px"
                required
              />
              <button class="btn btn-success" type="submit">Add tokens</button>
            </form>
          </td>
          <td>
            <form
              method="POST"
              style="display: inline"
              onsubmit="
                            var c = (this.querySelector('input[name=count]').value)*-1;
                            if(!c || c >= 0){ alert('Enter a valid number'); return false; }
                            this.action='{{ url_for('admin.add_tokens', user_id=user.id, count=0) }}'.replace('/0','/'+c);
                            return confirm('Add tokens?');
                        "
            >
              <input
                type="number"
                name="count"
                min="1"
                value="10"
                style="width: 60px; margin-right: 5px"
                required
              />
              <button class="btn btn-sm btn-danger">Remove tokens</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    <a id="register-user" href="/sign-up">Register user</a>
  </div>
</body>

{% endblock %}
